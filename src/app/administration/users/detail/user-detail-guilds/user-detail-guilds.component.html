<app-card [title]="'Servery'" icon="fas fa-server" [allowHideButton]="true">
    <div class="row" [class.mt-3]="i > 0" *ngFor="let guild of userGuilds; let i = index">
        <div class="col">
            <app-card [header]="false">
                <div class="alert alert-warning" *ngIf="!guild.isGuildKnown">
                    <i class="fas fa-exclamation-triangle"></i>
                    GrillBot se nenachází na tomto serveru. Data mohou být nekompletní.
                </div>

                <div class="alert alert-warning" *ngIf="guild.isGuildKnown && !guild.isUserInGuild">
                    <i class="fas fa-exclamation-triangle"></i>
                    Uživatel nebyl na tomto serveru nalezen.
                </div>

                <div class="row mb-3">
                    <div keyValueItem class="col-2" [key]="'Server'" [value]="guild.guild.name"></div>
                    <div keyValueItem class="col-2" [key]="'Serverový nick'" [value]="guild.nickname ?? 'Nenastaven'"></div>
                    <div keyValueItem class="col-2" [key]="'Body'" [value]="guild.points.toLocaleString()"></div>
                    <div keyValueItem class="col-2" [key]="'Počet udělených reakcí'" [value]="guild.givenReactions.toLocaleString()"></div>
                    <div keyValueItem class="col-2" [key]="'Počet obdržených reakcí'" [value]="guild.obtainedReactions.toLocaleString()"></div>
                </div>

                <div class="row mb-3" *ngIf="guild.usedInvite">
                    <div class="col">
                        Použitá pozvánka<br>
                        <b>
                            {{guild.usedInvite.code}}
                            <ng-container *ngIf="guild.usedInvite.creator">({{guild.usedInvite.creator.fullUsername}}) </ng-container>
                            <ng-container *ngIf="guild.usedInvite.createdAt">({{guild.usedInvite.createdAt.toLocaleString()}})</ng-container>
                        </b>
                    </div>
                </div>

                <div class="row" *ngIf="guild.createdInvites && guild.createdInvites.length > 0">
                    <div class="col-6">
                        Seznam vytvořených pozvánek<br>
                        <table class="table table-sm table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Kód</th>
                                    <th>Vytvořeno</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let invite of guild.createdInvites">
                                    <td>{{invite.code}}</td>
                                    <td>{{invite.createdAt.toLocaleString()}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="row" *ngIf="guild.channels && guild.channels.length > 0">
                    <div class="col">
                        Aktivita v kanálech<br>
                        <table class="table table-sm table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Kanál</th>
                                    <th>Počet zpráv</th>
                                    <th>První zpráva</th>
                                    <th>Poslední zpráva</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let channel of guild.channels">
                                    <td>{{channel.channel.name}}</td>
                                    <td>{{channel.count.toLocaleString()}}</td>
                                    <td>{{channel.firstMessageAt.toLocaleString()}}</td>
                                    <td>{{channel.lastMessageAt.toLocaleString()}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </app-card>
        </div>
    </div>
</app-card>
